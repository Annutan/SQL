/* Задача: "География литературных цен"

Описание задачи:
Проанализировать, как бы распределились книги по городам, если бы цена книги зависела от города. Представим, что в каждом городе действует свой ценовой коэффициент:
- Москва: цены остаются без изменений (коэффициент 1.0)
- Санкт-Петербург: цены снижаются на 15% (коэффициент 0.85)
- Владивосток: цены повышаются на 25% (коэффициент 1.25) из-за дальневосточной надбавки

Вывести для каждого города список книг с пересчитанной ценой и информацией об авторе и жанре. */


SELECT
    c.name_city AS 'Город',
    b.title AS 'Название книги',
    a.name_author AS 'Автор',
    g.name_genre AS 'Жанр',
    b.price AS 'Исходная цена',
    ROUND(
        CASE
            WHEN c.city_id = 1 THEN b.price * 1.0      -- Москва
            WHEN c.city_id = 2 THEN b.price * 0.85     -- Санкт-Петербург
            WHEN c.city_id = 3 THEN b.price * 1.25     -- Владивосток
        END, 2
    ) AS 'Цена в городе',
    b.amount AS 'Количество'
FROM
    book b
    CROSS JOIN city c  -- Создаем комбинации всех книг со всеми городами
    INNER JOIN author a ON b.author_id = a.author_id
    INNER JOIN genre g ON b.genre_id = g.genre_id
ORDER BY
    c.name_city,
    b.title;

