# Запросы SQL по результатам обучения в Stepik

### Интерактивный тренажер по SQL 
https://stepik.org/course/63054/info

## Задание 1.5.2

Создать таблицу поставок (`supply`), которая имеет ту же структуру, что и таблиц `book`.

| Поле | Тип, описание |
| :--- | :--- |
| `supply_id` | `INT PRIMARY KEY AUTO_INCREMENT` |
| `title` | `VARCHAR(50)` |
| `author` | `VARCHAR(30)` |
| `price` | `DECIMAL(8, 2)` |
| `amount` | `INT` |

## Задание 1.5.3

Занесите в таблицу `supply` четыре записи, чтобы получилась следующая таблица:

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Лирика | Пастернак Б.Л. | 518.99 | 2 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

<details>
<summary>Пояснение</summary>

Для просмотра полученной таблицы после запросов (запроса) на добавление вставить запрос на выборку всех данных из таблицы `supply`.
</details>

## Задание 1.5.4

Добавить из таблицы `supply` в таблицу `book` все книги, кроме книг, написанных Булгаковым М.А. и Достоевским Ф.М.

<details>
<summary>Пояснение</summary>

Задание нужно выполнить без вложенных запросов.
</details>

---

<details>
<summary>Структура и наполнение таблиц book и supply</summary>

### Таблица book

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Лирика | Пастернак Б.Л. | 518.99 | 2 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

</details>

## Задание 1.5.5

Занести из таблицы `supply` в таблицу `book` только те книги, авторов которых нет в `book`.

---

<details>
<summary>Структура и наполнение таблиц book и supply</summary>

### Таблица book

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Лирика | Пастернак Б.Л. | 518.99 | 2 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

</details>

## Задание 1.5.6

Уменьшить на 10% цену тех книг в таблице `book`, количество которых принадлежит интервалу от 5 до 10, включая границы.

---

<details>
<summary>Структура и наполнение таблицы book</summary>

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |
</details>

## Задание 1.5.7

В таблице `book` необходимо скорректировать значение для покупателя в столбце `buy` таким образом, чтобы оно не превышало количество экземпляров книг, указанных в столбце `amount`. А цену тех книг, которые покупатель не заказывал, снизить на 10%.

<details>
<summary>Пояснение</summary>

Запрос на обновление количества книг должен корректировать значения в столбце `buy` таблицы `book` следующим образом:

*   если покупатель заказал количество книг больше, чем есть на складе, то заменить значение `buy` на имеющееся на складе количество `amount`;
*   если покупатель хочет купить количество книг меньшее или равное количеству книг на складе, то значение `buy` изменять не надо.

Для реализации этого запроса можно использовать функцию `if()`. Синтаксис раздела `SET` при использовании функции `if()` следующий:

```sql
SET столбец = IF(условие, выражение_1, выражение_2)
```

Выполняется этот оператор так:

*   сначала вычисляется **условие**;
*   если условие ИСТИНА, то вычисляется **выражение_1**, в противном случае (если условие ЛОЖНО) вычисляется **выражение_2**;
*   в столбец заносится результат выполнения функции (либо значение **выражения_1**, либо значение **выражения_2** в зависимости от условия).

Например, для увеличения на 10% только цен книг Булгакова используется запрос:

```sql
UPDATE book
SET price = IF(author = "Булгаков М.А.", price * 1.1, price);
```
</details>

---

<details>
<summary>Структура и наполнение таблицы book</summary>

| book_id | title | author | price | amount | buy |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 | 0 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 | 3 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 | 8 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 | 0 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 | 18 |

</details>

## Задание 1.5.8

Для тех книг в таблице `book`, которые есть в таблице `supply`, не только увеличить их количество в таблице `book` (увеличить их количество на значение столбца `amount` таблицы `supply`), но и пересчитать их цену (для каждой книги найти сумму цен из таблиц `book` и `supply` и разделить на 2).

<details>
<summary>Пояснение</summary>

Пересчет для книг с одинаковым названием и ценой не повлияет на результат, поэтому в запросе не обязательно рассматривать два случая: когда цена у одинаковых книг равна и когда нет.
</details>

---

<details>
<summary>Структура и наполнение таблиц book и supply</summary>

### Таблица book

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Лирика | Пастернак Б.Л. | 518.99 | 2 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

</details>

## Задание 1.5.9

Удалить из таблицы `supply` книги тех авторов, общее количество экземпляров книг которых в таблице `book` превышает 10.

---

<details>
<summary>Структура и наполнение таблиц book и supply</summary>

### Таблица book

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Лирика | Пастернак Б.Л. | 518.99 | 2 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

</details>

## Задание 1.5.10

Создать таблицу заказ (`ordering`), куда включить авторов и названия тех книг, количество экземпляров которых в таблице `book` меньше среднего количества экземпляров книг в таблице `book`. В таблицу включить столбец `amount`, в котором для всех книг указать одинаковое значение - среднее количество экземпляров книг в таблице `book`.

---

<details>
<summary>Структура и наполнение таблицы book</summary>

| book_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | Булгаков М.А. | 670.99 | 3 |
| 2 | Белая гвардия | Булгаков М.А. | 540.50 | 5 |
| 3 | Идиот | Достоевский Ф.М. | 460.00 | 10 |
| 4 | Братья Карамазовы | Достоевский Ф.М. | 799.01 | 2 |
| 5 | Стихотворения и поэмы | Есенин С.А. | 650.00 | 15 |

</details>

## Задание 1.6.2

Вывести из таблицы `trip` информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а», в отсортированном по убыванию даты последнего дня командировки виде. В результат включить столбцы `name`, `city`, `per_diem`, `date_first`, `date_last`.

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.3

Вывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в командировке в Москве.

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.4

Для каждого города посчитать, сколько раз сотрудники в нем были. Информацию вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый столбец назвать **Количество**.

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.5

Вывести два города, в которых чаще всего были в командировках сотрудники. Вычисляемый столбец назвать **Количество**.

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.6

Вывести информацию о командировках во все города кроме Москвы и Санкт-Петербурга (фамилии и инициалы сотрудников, город, длительность командировки в днях, при этом первый и последний день относится к периоду командировки). Последний столбец назвать **Длительность**. Информацию вывести в упорядоченном по убыванию длительности поездки, а потом по убыванию названий городов (в обратном алфавитном порядке).

### Немного теории

Для вычитания двух дат используется функция `DATEDIFF(дата_1, дата_2)`, результатом которой является количество дней между `дата_1` и `дата_2`. Например,

```sql
DATEDIFF('2020-04-01', '2020-03-28')=4

DATEDIFF('2020-05-09','2020-05-01')=8

DATEDIFF(date_last, date_first)
```

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |
</details>

## Задание 1.6.7

Вывести информацию о командировках сотрудника(ов), которые были самыми короткими по времени. В результат включить столбцы `name`, `city`, `date_first`, `date_last`.

<details>
<summary>Пояснение</summary>

Используйте вложенный запрос, чтобы найти длительность самой короткой командировки.
</details>

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.8

Вывести информацию о командировках, начало и конец которых относятся к одному месяцу (год может быть любой). В результат включить столбцы `name`, `city`, `date_first`, `date_last`. Строки отсортировать сначала в алфавитном порядке по названию города, а затем по фамилии сотрудника.

### Немного теории

Для того, чтобы выделить номер месяца из даты используется функция `MONTH(дата)`.

Например, `MONTH('2020-04-12') = 4`.

Если определяется месяц для значений столбца `date_first`, то используется запись `MONTH(date_first)`

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.9

Вывести название месяца и количество командировок для каждого месяца. Считаем, что командировка относится к некоторому месяцу, если она началась в этом месяце. Информацию вывести сначала в отсортированном по убыванию количества, а потом в алфавитном порядке по названию месяца виде. Название столбцов – **Месяц** и **Количество**.

### Немного теории

1.  Для того, чтобы выделить название месяца из даты используется функция `MONTHNAME(дата)`, которая возвращает название месяца на английском языке для указанной даты. Например, `MONTHNAME('2020-04-12')='April'`.
2.  Если группировка осуществляется по вычисляемому столбцу (в данном случае «вычисляется» название месяца), то после `GROUP BY` можно указать как вычисляемое выражение, так и имя столбца, заданное с помощью `AS`. Важно отметить, что последний вариант (указать имя столбца) нарушает стандарт по порядку выполнения запросов, но иногда может встречаться на реальных платформах.

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | | | | | |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |
</details>

## Задание 1.6.10

Вывести сумму суточных (произведение количества дней командировки и размера суточных) для командировок, первый день которых пришелся на февраль или март 2020 года. Значение суточных для каждой командировки занесено в столбец `per_diem`. Вывести фамилию и инициалы сотрудника, город, первый день командировки и сумму суточных. Последний столбец назвать `Сумма`. Информацию отсортировать сначала в алфавитном порядке по фамилиям сотрудников, а затем по убыванию суммы суточных.

<details>
<summary>Пояснение</summary>

1. В SQL есть функции, которые позволяют выделить часть даты: день (`DAY()`), месяц (`MONTH()`), год (`YEAR()`). Например:

```sql
DAY('2020-02-01') = 1
MONTH('2020-02-01') = 2
YEAR('2020-02-01') = 2020
```

2. Количество дней командировки вычисляется как разница между датами последнего и первого дня командировки плюс 1.
</details>

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-02-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.6.11

Вывести фамилию с инициалами и общую сумму суточных, полученных за все командировки для тех сотрудников, которые были в командировках больше чем 3 раза, в отсортированном по убыванию сумм суточных виде. Последний столбец назвать `Сумма`.

Только для этого задания изменена строка таблицы `trip`:

| 4 | Ильиных Г.Р. | Владивосток | 450 | 2020-01-12 | 2020-03-02 |

---

<details>
<summary>Структура и наполнение таблицы trip</summary>

| trip_id | name | city | per_diem | date_first | date_last |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | Москва | 700.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | Владивосток | 450.00 | 2020-01-14 | 2020-01-27 |
| 3 | Семенов И.В. | Москва | 700.00 | 2020-01-23 | 2020-01-31 |
| 4 | Ильиных Г.Р. | Владивосток | 450.00 | 2020-01-12 | 2020-03-02 |
| 5 | Колесов С.П. | Москва | 700.00 | 2020-02-01 | 2020-02-06 |
| 6 | Баранов П.Е. | Москва | 700.00 | 2020-02-14 | 2020-02-22 |
| ... | ... | ... | ... | ... | ... |
| 19 | Абрамова К.А. | Владивосток | 450.00 | 2020-07-02 | 2020-07-13 |
| 20 | Баранов П.Е. | Воронеж | 450.00 | 2020-07-19 | 2020-07-25 |

</details>

## Задание 1.7.2

Создать таблицу `fine` следующей структуры:

| Поле | Описание |
| :--- | :--- |
| `fine_id` | ключевой столбец целого типа с автоматическим увеличением значения ключа на 1 |
| `name` | строка длиной 30 |
| `number_plate` | строка длиной 6 |
| `violation` | строка длиной 50 |
| `sum_fine` | вещественное число, максимальная длина 8, количество знаков после запятой 2 |
| `date_violation` | дата |
| `date_payment` | дата |

## Задание 1.7.3

В таблицу `fine` первые 5 строк уже занесены. Добавить в таблицу записи с ключевыми значениями 6, 7, 8.

| fine_id | name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Баранов П.Е. | P523BT | Превышение скорости (от 40 до 60) | 500.00 | 2020-01-12 | 2020-01-17 |
| 2 | Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| 3 | Яковлев Г.Р. | T330TT | Превышение скорости (от 20 до 40) | 500.00 | 2020-01-23 | 2020-02-23 |
| 4 | Яковлев Г.Р. | M701AA | Превышение скорости (от 20 до 40) | | 2020-01-12 | |
| 5 | Колесов С.П. | K892AX | Превышение скорости (от 20 до 40) | | 2020-02-01 | |
| 6 | Баранов П.Е. | P523BT | Превышение скорости (от 40 до 60) | | 2020-02-14 | |
| 7 | Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | | 2020-02-23 | |
| 8 | Яковлев Г.Р. | T330TT | Проезд на запрещающий сигнал | | 2020-03-03 | |

### Пояснение

1. Между формулировкой нарушения и открывающей скобкой ПРОБЕЛА НЕТ. Например, **Превышение скорости(от 40 до 60)**.
2. Для занесения пустых значений в поля используется оператор `Null`.
3. Номера машин записывать РУССКИМИ буквами.

### Важно

При создании запроса текст с названием нарушений **нужно копировать из таблицы Результат**, а не из первой таблицы.

## Задание 1.7.4

Занести в таблицу `fine` суммы штрафов, которые должен оплатить водитель, в соответствии с данными из таблицы `traffic_violation`. При этом суммы заносить только в пустые поля столбца `sum_fine`.

Таблица `traffic_violation` создана и заполнена.

**Важно!** Сравнение значения столбца с пустым значением осуществляется с помощью оператора `IS NULL`.

<details>
<summary>Пояснение</summary>

1. После ключевого слова `UPDATE` кроме обновляемой таблицы `fine` укажите таблицу `traffic_violation`, для того чтобы запрос видел таблицы источники. Сначала перечисляем все источники, потом выполняем необходимые действия.

2. Обновляйте только те записи таблицы `fine`, у которых значение столбца `violation` совпадает со значением соответствующего столбца таблицы `traffic_violation`, а также значение столбца `sum_fine` пусто.
</details>

---

<details>
<summary>Структура и наполнение исходной таблицы fine (без ключевого столбца) и таблицы traffic_violation</summary>

### Таблица traffic_violation:

| violation_id | violation | sum_fine |
| :--- | :--- | :--- |
| 1 | Превышение скорости(от 20 до 40) | 500.00 |
| 2 | Превышение скорости(от 40 до 60) | 1000.00 |
| 3 | Проезд на запрещающий сигнал | 1000.00 |

### Таблица fine:

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | NULL | 2020-01-12 | NULL |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | NULL | 2020-02-01 | NULL |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | NULL | 2020-02-14 | NULL |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | NULL | 2020-02-23 | NULL |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | NULL | 2020-03-03 | NULL |

</details>

## Задание 1.7.5

Вывести фамилию, номер машины и нарушение только для тех водителей, которые на одной машине нарушили одно и то же правило два и более раз. При этом учитывать все нарушения, независимо от того оплачены они или нет. Информацию отсортировать в алфавитном порядке, сначала по фамилии водителя, потом по номеру машины и, наконец, по нарушению.

<details>
<summary>Пояснение</summary>

Под увеличение штрафа в два раза подходит водитель «Абрамова К.А.», который на машине с государственным номером «О111АВ» совершил повторное нарушение «Проезд на запрещающий сигнал», а также водитель «Баранов П.Е.», который на машине с номером «Р523ВТ» дважды совершил нарушение «Превышение скорости(от 40 до 60)».
</details>

---

<details>
<summary>Структура и наполнение таблицы fine (без ключевого столбца) перед выполнением этого шага</summary>

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | 500.00 | 2020-01-12 | NULL |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | 500.00 | 2020-02-01 | NULL |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 1000.00 | 2020-02-14 | NULL |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | 1000.00 | 2020-02-23 | NULL |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | 1000.00 | 2020-03-03 | NULL |
</details>

## Задание 1.7.6

В таблице `fine` увеличить в два раза сумму неоплаченных штрафов для отобранных на предыдущем шаге записей.

<details>
<summary>Пояснение <b style="color: green;">!!! если не получается запрос или валидатор выдает ошибки, раскройте это пояснение!!!</b></summary>

1. Для всех нарушений, по которым штраф еще не оплачен, (тех, у которых `date_payment` имеет пустое значение `Null`), необходимо проверить, является ли данное нарушение для водителя и машины повторным, если да – увеличить штраф в два раза.

2. Если водитель совершил нарушение на другой машине, ему увеличивать штраф не нужно.

3. Если несколько повторных нарушений не оплачены, то штраф увеличить для всех.

4. Этот запрос реализован на предыдущем шаге.

При реализации можно использовать вложенный запрос как отдельную таблицу, записанную после ключевого слова `UPDATE`, при этом вложенному запросу необходимо присвоить имя, например `query_in`:

```sql
UPDATE fine,
    (
        SELECT ...
    ) query_in
SET ...
WHERE указать, что совпадают нарушение, фамилия водителя и номер машины в таблицах fine и вложенном запросе query_in соответственно, а также дата оплаты в таблице fine пуста
```

Другим способом решения является использование двух запросов: сначала создать временную таблицу, например `query_in`, в которую включить информацию о тех штрафах, сумму которых нужно увеличить в два раза, а затем уже обновлять информацию в таблице `fine`:

```sql
CREATE TABLE query_in ...;

UPDATE fine, query_in
SET ...
WHERE ...;
```

После ключевого слова `WHERE` указывается условие, при котором нужно обновлять данные. В нашем случае данные обновляются, если и фамилия, и государственный номер, и нарушение совпадают в таблице `fine` и в результирующей таблице запроса `query_in`. Например, для связи по фамилии используется запись `fine.name = query_in.name`. Также в условии нужно учесть, что данные обновляются только для тех записей, у которых в столбце `date_payment` пусто.

**Важно!** Если в запросе используется несколько таблиц или запросов, включающих одинаковые поля, то применяется полное имя столбца, включающего название таблицы через символ «.». Например, `fine.name` и `query_in.name`.
</details>

---

<details>
<summary>Структура и наполнение таблицы fine (без ключевого столбца) перед выполнением этого шага</summary>

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | 500.00 | 2020-01-12 | Null |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | 500.00 | 2020-02-01 | Null |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 1000.00 | 2020-02-14 | Null |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | 1000.00 | 2020-02-23 | Null |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | 1000.00 | 2020-03-03 | Null |

</details>

## Задание 1.7.7

Водители оплачивают свои штрафы. В таблице `payment` занесены даты их оплаты:

| payment_id | name | number_plate | violation | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Яковлев Г.Р. | M701AA | Превышение скорости (от 20 до 40) | 2020-01-12 | 2020-01-22 |
| 2 | Баранов П.Е. | P523BT | Превышение скорости (от 40 до 60) | 2020-02-14 | 2020-03-06 |
| 3 | Яковлев Г.Р. | T330TT | Проезд на запрещающий сигнал | 2020-03-03 | 2020-03-23 |

Необходимо:

*   в таблицу `fine` занести дату оплаты соответствующего штрафа из таблицы `payment`;
*   уменьшить начисленный штраф в таблице `fine` в два раза (только для тех штрафов, информация о которых занесена в таблицу `payment`), если оплата произведена не позднее 20 дней со дня нарушения.

<details>
<summary>Пояснение к заданию</summary>

1.  Для уменьшения суммы штрафа в два раза в зависимости от условия можно использовать функцию `if()`. Синтаксис раздела `SET` при использовании функции `if()` следующий:

    ```sql
    SET столбец = IF(условие, выражение_1, выражение_2)
    ```

    Выполняется этот оператор так:

    *   сначала вычисляется **условие**;
    *   если условие ИСТИНА, то вычисляется **выражение_1**, в противном случае (если условие ЛОЖНО) вычисляется **выражение_2**;
    *   в столбец заносится результат выполнения функции (либо значение **выражения_1**, либо значение **выражения_2** в зависимости от условия).

    Например, чтобы обнулить штрафы, меньшие или равные 500 рублей, а остальные оставить без изменения, используется запрос:

    ```sql
    UPDATE fine
    SET sum_fine = IF(sum_fine <= 500, 0, sum_fine)
    ```

2.  Количество дней между датой нарушения и датой оплаты считается по формуле:

    `количество_дней = дата_оплаты - дата_нарушения`
</details>

<details>
<summary>Пояснение к решению</summary>

**Шаблон запроса:**

```sql
UPDATE
    fine, payment
SET
    fine.date_payment = дата оплаты из payment,
    fine.sum_fine = сравнить разницу между датой нарушения и датой оплаты (из payment)
                    и при необходимости уменьшить размер штрафа (использовать IF)
WHERE
    указать условие, что совпадают и номера машин, и нарушения, и
    фамилия водителя в таблицах fine и payment, а также, что
    дата оплаты в fine должна быть пуста
```
</details>

---

<details>
<summary> Структура и наполнение таблицы fine (без ключевого столбца) перед выполнением этого шага</summary>

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | 500.00 | 2020-01-12 | NULL |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | 500.00 | 2020-02-01 | NULL |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 2000.00 | 2020-02-14 | NULL |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | 2000.00 | 2020-02-23 | NULL |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | 1000.00 | 2020-03-03 | NULL |
</details>

## Задание 1.7.8

Создать новую таблицу `back_payment`, куда внести информацию о неоплаченных штрафах (Фамилию и инициалы водителя, номер машины, нарушение, сумму штрафа и дату нарушения) из таблицы `fine`.

<details>
<summary>Пояснение</summary>

Для неоплаченных штрафов столбец `date_payment` имеет пустое значение.
</details>

**Важно.** На этом шаге необходимо создать таблицу на основе запроса! Не нужно одним запросом создавать таблицу, а вторым в нее добавлять строки.

---

<details>
<summary>Структура и наполнение таблицы fine (без ключевого столбца) перед выполнением этого шага</summary>

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | 250.00 | 2020-01-12 | 2020-01-22 |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | 500.00 | 2020-02-01 | NULL |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 2000.00 | 2020-02-14 | 2020-03-05 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | 2000.00 | 2020-02-23 | NULL |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | 500.00 | 2020-03-03 | 2020-03-22 |
</details>

## Задание 1.7.9

Удалить из таблицы `fine` информацию о нарушениях, совершенных раньше 1 февраля 2020 года.

---

<details>
<summary>Структура и наполнение таблицы fine (без ключевого столбца) перед выполнением этого шага</summary>

| name | number_plate | violation | sum_fine | date_violation | date_payment |
| :--- | :--- | :--- | :--- | :--- | :--- |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 500.00 | 2020-01-12 | 2020-01-17 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигнал | 1000.00 | 2020-01-14 | 2020-02-27 |
| Яковлев Г.Р. | T330TT | Превышение скорости(от 20... | 500.00 | 2020-01-23 | 2020-02-23 |
| Яковлев Г.Р. | M701AA | Превышение скорости(от 20... | 250.00 | 2020-01-12 | 2020-01-22 |
| Колесов С.П. | K892AX | Превышение скорости(от 20... | 500.00 | 2020-02-01 | NULL |
| Баранов П.Е. | P523BT | Превышение скорости(от 40... | 2000.00 | 2020-02-14 | 2020-03-05 |
| Абрамова К.А. | O111AB | Проезд на запрещающий сигн... | 2000.00 | 2020-02-23 | NULL |
| Яковлев Г.Р. | T330TT | Проезд на запрещающий сигн... | 500.00 | 2020-03-03 | 2020-03-22 |
</details>

## Задание 2.1.6

Создать таблицу `author` следующей структуры:

| Поле | Тип, описание |
| :--- | :--- |
| `author_id` | `INT PRIMARY KEY AUTO_INCREMENT` |
| `name_author` | `VARCHAR(50)` |

## Задание 2.1.7

Заполнить таблицу `author`. В нее включить следующих авторов:

- Булгаков М.А.
- Достоевский Ф.М.
- Есенин С.А.
- Пастернак Б.Л.

## Задание 2.1.8

Перепишите запрос на создание таблицы `book`, чтобы ее структура соответствовала структуре, показанной на логической схеме (таблица `genre` уже создана, порядок следования столбцов - как на логической схеме в таблице `book`, `genre_id` - внешний ключ). Для `genre_id` ограничение о недопустимости пустых значений **не задавать**. В качестве главной таблицы для описания поля `genre_id` использовать таблицу `genre` следующей структуры:

| Поле | Тип, описание |
| :--- | :--- |
| `genre_id` | `INT PRIMARY KEY AUTO_INCREMENT` |
| `name_genre` | `VARCHAR(30)` |

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

## Задание 2.1.9

Создать таблицу `book` той же структуры, что и на предыдущем шаге. Будем считать, что при удалении автора из таблицы `author`, должны удаляться все записи о книгах из таблицы `book`, написанные этим автором. А при удалении жанра из таблицы `genre` для соответствующей записи `book` установить значение `Null` в столбце `genre_id`.

## Задание 2.1.11

Добавьте три последние записи (с ключевыми значениями 6, 7, 8) в таблицу `book`, первые 5 записей уже добавлены:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

## Задание 2.2.2

Вывести название, жанр и цену тех книг, количество которых больше 8, в отсортированном по убыванию цены виде.

**Логическая схема базы данных:**

*(Схема показывает связи между таблицами `genre`, `author` и `book`)*
 
- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.2.3

Вывести все жанры, которые не представлены в книгах на складе.

**Логическая схема базы данных:**

*(Схема показывает связи между таблицами `genre`, `author` и `book`)*
- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.2.4

Есть список городов, хранящийся в таблице `city`:

| city_id | name_city |
| :--- | :--- |
| 1 | Москва |
| 2 | Санкт-Петербург |
| 3 | Владивосток |

Необходимо в каждом городе провести выставку книг каждого автора в течение 2020 года. Дату проведения выставки выбрать случайным образом. Создать запрос, который выведет город, автора и дату проведения выставки. Последний столбец назвать **Дата**. Информацию вывести, отсортировав сначала в алфавитном порядке по названиям городов, а потом по убыванию дат проведения выставок.

**Структура таблицы:**

| author | 
|:-------| 
| author_id PK | 
| name_author | 

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица city:

| city_id | name_city |
| :--- | :--- |
| 1 | Москва |
| 2 | Санкт-Петербург |
| 3 | Владивосток |

</details>

## Задание 2.2.5

Вывести информацию о книгах (жанр, книга, автор), относящихся к жанру, включающему слово «роман» в отсортированном по названиям книг виде.

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.2.6

Посчитать количество экземпляров книг каждого автора из таблицы `author`. Вывести тех авторов, количество книг которых меньше 10, в отсортированном по возрастанию количества виде. Последний столбец назвать `Количество`.

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.2.7

Вывести в алфавитном порядке всех авторов, которые пишут только в одном жанре. Поскольку у нас в таблицах так занесены данные, что у каждого автора книги только в одном жанре, для этого запроса внесем изменения в таблицу `book`. Пусть у нас книга Есенина «Черный человек» относится к жанру «Роман», а книга Булгакова «Белая гвардия» к «Приключениям» (эти изменения в таблицы уже внесены).

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 3 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 1 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.2.8

Вывести информацию о книгах (название книги, фамилию и инициалы автора, название жанра, цену и количество экземпляров книги), написанных в самых популярных жанрах, в отсортированном в алфавитном порядке по названию книг виде. Самым популярным считать жанр, общее количество экземпляров книг которого на складе максимально.

**Логическая схема базы данных:**

- `genre.genre_id` → `book.genre_id` (один ко многим)
- `author.author_id` → `book.author_id` (один ко многим)

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица genre:

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 4 | Игрок | 2 | 1 | 480.50 | 10 |
| 5 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 6 | Черный человек | 3 | 2 | 570.20 | 6 |
| 7 | Лирика | 4 | 2 | 518.99 | 10 |
| 8 | Идиот | 2 | 1 | 460.00 | 10 |
| 9 | Герой нашего времени | 5 | 3 | 570.59 | 2 |
| 10 | Доктор Живаго | 4 | 3 | 740.50 | 5 |

</details>

## Задание 2.2.9

Если в таблицах `supply` и `book` есть одинаковые книги, которые имеют равную цену, вывести их название и автора, а также посчитать общее количество экземпляров книг в таблицах `supply` и `book`, столбцы назвать `Название`, `Автор` и `Количество`.

**Логическая схема базы данных:**

- `author.author_id` → `book.author_id` (один ко многим)
- `supply` не имеет прямых внешних ключей, но связана с `book` по названию книги и автору

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица supply:

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 618.99 | 3 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Евгений Онегин | Пушкин А.С. | 440.80 | 5 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |

### Таблица author:

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица book:

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

</details>

## Задание 2.3.2

Для книг, которые уже есть на складе (в таблице `book`), но по другой цене, чем в поставке (`supply`), необходимо в таблице `book` увеличить количество на значение, указанное в поставке, и пересчитать цену. А в таблице `supply` обнулить количество этих книг. Формула для пересчета цены:

$$ price = \frac{(p_1 * k_1 + p_2 * k_2)}{k_1 + k_2} $$

где $p_1, p_2$ - цена книги в таблицах `book` и `supply`;
$k_1, k_2$ - количество книг в таблицах `book` и `supply`.

<details>
<summary>Пояснение</summary>

Пересчитываться должна цена только одной книги Достоевского «Идиот», для этой же книги увеличится количество в таблице `book` и обнулится количество в таблице `supply`.
</details>

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 5 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.3

Включить новых авторов в таблицу `author` с помощью запроса на добавление, а затем вывести все данные из таблицы `author`. Новыми считаются авторы, которые есть в таблице `supply`, но нет в таблице `author`.

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 460.00 | 10 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 6 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 12 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.4

Добавить новые книги из таблицы `supply` в таблицу `book` на основе сформированного выше запроса. Затем вывести для просмотра таблицу `book`.

<details>
<summary>Пояснение</summary>

Если нужно оставить какое-то поле пустым - его просто не указывают в списке полей таблицы, в которую добавляются записи.
</details>

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 437.11 | 13 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 12 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 0 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 0 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 0 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |
| 6 | Стивенсон Р.Л. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.5

Занести для книги «Стихотворения и поэмы» Лермонтова жанр «Поэзия», а для книги «Остров сокровищ» Стивенсона - «Приключения». (Использовать два запроса).

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 437.11 | 13 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 12 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |
| 9 | Доктор Живаго | 4 | 1 | 380.80 | 4 |
| 10 | Стихотворения и поэмы | 5 | Null | 255.90 | 4 |
| 11 | Остров сокровищ | 6 | Null | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |
| 6 | Стивенсон Р.Л. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.6

Удалить всех авторов и все их книги, общее количество книг которых меньше 20.

<details>
<summary>Пояснение</summary>

Для подсчета количества книг каждого автора используйте вложенный запрос.
</details>

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 437.11 | 13 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 12 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |
| 9 | Доктор Живаго | 4 | 1 | 380.80 | 4 |
| 10 | Стихотворения и поэмы | 5 | 2 | 255.90 | 4 |
| 11 | Остров сокровищ | 6 | 3 | 599.99 | 5 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |
| 6 | Стивенсон Р.Л. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.7

Удалить все жанры, к которым относится меньше 4-х наименований книг. В таблице `book` для этих жанров установить значение `Null`.

<details>
<summary>Пояснение</summary>

1. В запросе считать **все уникальные книги**. Например, книги "Стихотворения и поэмы" написаны разными авторами и имеют разный `book_id`, то есть это разные книги.
2. Для отбора жанров, к которым относится меньше 4-х книг, использовать вложенный запрос.
</details>

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 437.11 | 13 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 12 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |
| 9 | Доктор Живаго | 4 | 1 | 380.80 | 4 |
| 10 | Стихотворения и поэмы | 5 | 2 | 255.90 | 4 |
| 11 | Остров сокровищ | 6 | 3 | 599.99 | 5 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |
| 6 | Стивенсон Р.Л. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

## Задание 2.3.8

Удалить всех авторов, которые пишут в жанре "Поэзия". Из таблицы `book` удалить все книги этих авторов. В запросе для отбора авторов использовать полное название жанра, а не его `id`.

---

<details>
<summary>Структура и наполнение таблиц</summary>

### Таблица book

| book_id | title | author_id | genre_id | price | amount |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | Мастер и Маргарита | 1 | 1 | 670.99 | 3 |
| 2 | Белая гвардия | 1 | 1 | 540.50 | 12 |
| 3 | Идиот | 2 | 1 | 437.11 | 13 |
| 4 | Братья Карамазовы | 2 | 1 | 799.01 | 3 |
| 5 | Игрок | 2 | 1 | 480.50 | 10 |
| 6 | Стихотворения и поэмы | 3 | 2 | 650.00 | 15 |
| 7 | Черный человек | 3 | 2 | 570.20 | 12 |
| 8 | Лирика | 4 | 2 | 518.99 | 2 |
| 9 | Доктор Живаго | 4 | 1 | 380.80 | 4 |
| 10 | Стихотворения и поэмы | 5 | 2 | 255.90 | 4 |
| 11 | Остров сокровищ | 6 | 3 | 599.99 | 5 |

### Таблица supply

| supply_id | title | author | price | amount |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Доктор Живаго | Пастернак Б.Л. | 380.80 | 4 |
| 2 | Черный человек | Есенин С.А. | 570.20 | 6 |
| 3 | Белая гвардия | Булгаков М.А. | 540.50 | 7 |
| 4 | Идиот | Достоевский Ф.М. | 360.80 | 3 |
| 5 | Стихотворения и поэмы | Лермонтов М.Ю. | 255.90 | 4 |
| 6 | Остров сокровищ | Стивенсон Р.Л. | 599.99 | 5 |

### Таблица author

| author_id | name_author |
| :--- | :--- |
| 1 | Булгаков М.А. |
| 2 | Достоевский Ф.М. |
| 3 | Есенин С.А. |
| 4 | Пастернак Б.Л. |
| 5 | Лермонтов М.Ю. |
| 6 | Стивенсон Р.Л. |

### Таблица genre

| genre_id | name_genre |
| :--- | :--- |
| 1 | Роман |
| 2 | Поэзия |
| 3 | Приключения |

</details>

